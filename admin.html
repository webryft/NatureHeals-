<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nature Heals Admin</title>
<style>
body { font-family: Poppins, sans-serif; background:#f9fafb; color:#333; padding:20px; }
.card { background:#fff; padding:15px; border-radius:10px; box-shadow:0 3px 10px rgba(0,0,0,0.1); margin-bottom:15px; }
h2 { margin-top:0; }
input,button { padding:8px; margin-top:5px; border-radius:8px; border:1px solid #ccc; }
button { cursor:pointer; background:#10b981; color:white; border:none; font-weight:600; }
button.danger { background:#ef4444; }
img { border-radius:8px; max-width:100%; }
</style>
</head>
<body>
<h1>Nature Heals Admin Panel</h1>

<div class="card">
  <h2>Add New Product</h2>
  <input id="prodName" placeholder="Picture name"><br>
  <input id="prodPrice" type="number" placeholder="Price"><br>
  <input id="prodImage" type="file" accept="image/*"><br>
  <button id="addProd">Add Product</button>
</div>

<div class="card">
  <h2>Current Products</h2>
  <div id="prodList">Loading...</div>
</div>

<div class="card">
  <h2>Upload Cover</h2>
  <input id="coverFile" type="file" accept="image/*">
  <button id="uploadCover">Upload Cover</button>
</div>

<div class="card">
  <h2>Upload Audio</h2>
  <input id="audioFile" type="file" accept="audio/*">
  <button id="uploadAudio">Upload Audio</button>
</div>

<script type="module">
// ----- Firebase SDK imports from step 1 -----
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
  import { getFirestore, collection, addDoc, deleteDoc, doc, getDocs } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-firestore.js";
  import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-storage.js";
  import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

  // --- Paste your firebaseConfig object here ---

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const storage = getStorage(app);
  const auth = getAuth(app);

// Load existing products
async function loadProducts() {
  const snap = await getDocs(collection(db, "products"));
  const container = document.getElementById("prodList");
  container.innerHTML = "";
  snap.forEach(docSnap => {
    const p = docSnap.data();
    const div = document.createElement("div");
    div.innerHTML = `
      <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
        <img src="${p.imageURL}" width="80">
        <div style="flex:1;">
          <b>${p.name}</b><br>â‚¦${p.price}
        </div>
        <button class="danger" data-id="${docSnap.id}">Remove</button>
      </div>`;
    container.appendChild(div);
  });
}

// Add new product
document.getElementById("addProd").onclick = async () => {
  const name = document.getElementById("prodName").value;
  const price = Number(document.getElementById("prodPrice").value);
  const file = document.getElementById("prodImage").files[0];
  if(!name || !price || !file){ alert("Fill all fields"); return; }

  const storageRef = ref(storage, "products/" + file.name);
  await uploadBytes(storageRef, file);
  const imageURL = await getDownloadURL(storageRef);

  await addDoc(collection(db, "products"), { name, price, imageURL });
  alert("Product added!");
  loadProducts();
};

// Remove product
document.getElementById("prodList").addEventListener("click", async(e)=>{
  if(e.target.classList.contains("danger")){
    const id = e.target.dataset.id;
    await deleteDoc(doc(db, "products", id));
    alert("Product removed");
    loadProducts();
  }
});

// Upload cover
document.getElementById("uploadCover").onclick = async ()=>{
  const file = document.getElementById("coverFile").files[0];
  if(!file){ alert("Select a file"); return; }
  await uploadBytes(ref(storage, "cover/cover.gif"), file);
  alert("Cover updated!");
};

// Upload audio
document.getElementById("uploadAudio").onclick = async ()=>{
  const file = document.getElementById("audioFile").files[0];
  if(!file){ alert("Select a file"); return; }
  await uploadBytes(ref(storage, "audio/background.mp3"), file);
  alert("Audio uploaded!");
};

loadProducts();
</script>
</body>
</html>
